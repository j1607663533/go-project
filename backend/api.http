### Gin Backend API 测试文件
### 使用 VS Code REST Client 扩展或其他 HTTP 客户端

@baseUrl = http://localhost:8080
@apiUrl = {{baseUrl}}/api/v1

### ========== 认证接口 ==========

### 1. 获取验证码
GET {{apiUrl}}/captcha

### 2. 刷新验证码（使用上一步返回的 captcha_id）
GET {{apiUrl}}/captcha?refresh=YOUR_CAPTCHA_ID_HERE

### 3. 验证验证码（测试用）
POST {{apiUrl}}/captcha/verify
Content-Type: application/json

{
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "123456"
}

### ========== 注册接口 ==========

### 4. 用户注册
POST {{apiUrl}}/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "testuser@example.com",
  "password": "password123",
  "nickname": "测试用户",
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "YOUR_CAPTCHA_CODE_HERE"
}

### 5. 用户注册 - 验证码错误
POST {{apiUrl}}/register
Content-Type: application/json

{
  "username": "testuser2",
  "email": "testuser2@example.com",
  "password": "password123",
  "nickname": "测试用户2",
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "wrong"
}

### 6. 用户注册 - 用户名已存在
POST {{apiUrl}}/register
Content-Type: application/json

{
  "username": "bob",
  "email": "newemail@example.com",
  "password": "password123",
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "YOUR_CAPTCHA_CODE_HERE"
}

### ========== 登录接口 ==========

### 4. 用户登录（需要验证码）
POST {{apiUrl}}/login
Content-Type: application/json

{
  "username": "bob",
  "password": "password123",
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "YOUR_CAPTCHA_CODE_HERE"
}

### 5. 用户登录 - 验证码错误
POST {{apiUrl}}/login
Content-Type: application/json

{
  "username": "bob",
  "password": "password123",
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "wrong"
}

### 6. 用户登录 - 错误的密码
POST {{apiUrl}}/login
Content-Type: application/json

{
  "username": "bob",
  "password": "wrongpassword",
  "captcha_id": "YOUR_CAPTCHA_ID_HERE",
  "captcha": "YOUR_CAPTCHA_CODE_HERE"
}

### 7. 获取个人信息（需要先登录获取 token）
# 先执行上面的登录请求，复制返回的 token，替换下面的 YOUR_TOKEN_HERE
GET {{apiUrl}}/auth/profile
Authorization: Bearer YOUR_TOKEN_HERE

### 8. 获取个人信息 - 无 Token
GET {{apiUrl}}/auth/profile

### 9. 获取个人信息 - 无效 Token
GET {{apiUrl}}/auth/profile
Authorization: Bearer invalid_token_here

### ========== 基础接口 ==========

### 1. 健康检查
GET {{baseUrl}}/health

### ========== 用户管理 - 正常请求 ==========

### 2. 获取用户列表
GET {{apiUrl}}/users

### 3. 获取单个用户
GET {{apiUrl}}/users/1

### 4. 创建用户（正确）
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com",
  "password": "password123",
  "nickname": "测试用户"
}

### 5. 更新用户（正确）
PUT {{apiUrl}}/users/1
Content-Type: application/json

{
  "email": "newemail@example.com",
  "nickname": "新昵称",
  "avatar": "https://example.com/avatar.jpg"
}

### 6. 删除用户
DELETE {{apiUrl}}/users/2

### ========== 参数验证测试 ==========

### 7. 创建用户 - 缺少必填字段
POST {{apiUrl}}/users
Content-Type: application/json

{
  "email": "test@example.com"
}

### 8. 创建用户 - 用户名太短
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "ab",
  "email": "test@example.com",
  "password": "123456"
}

### 9. 创建用户 - 用户名包含特殊字符
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "test@user",
  "email": "test@example.com",
  "password": "123456"
}

### 10. 创建用户 - 邮箱格式错误
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "testuser",
  "email": "invalid-email",
  "password": "123456"
}

### 11. 创建用户 - 密码太短
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com",
  "password": "123"
}

### 12. 创建用户 - 用户名太长
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "verylongusernamethatexceedsmaximumlength",
  "email": "test@example.com",
  "password": "123456"
}

### 13. 更新用户 - 头像 URL 格式错误
PUT {{apiUrl}}/users/1
Content-Type: application/json

{
  "avatar": "not-a-valid-url"
}

### 14. 更新用户 - 邮箱格式错误
PUT {{apiUrl}}/users/1
Content-Type: application/json

{
  "email": "invalid-email-format"
}

### 15. 获取用户 - 无效的 ID
GET {{apiUrl}}/users/abc

### 16. 获取用户 - 不存在的用户
GET {{apiUrl}}/users/999

### ========== 业务逻辑测试 ==========

### 17. 创建用户 - 用户名已存在
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "admin",
  "email": "newadmin@example.com",
  "password": "123456"
}

### 18. 创建用户 - 邮箱已存在
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "newadmin",
  "email": "admin@example.com",
  "password": "123456"
}

### ========== 认证接口 ==========

### 19. 获取个人信息（需要认证）- 无 Token
GET {{apiUrl}}/auth/profile

### 20. 获取个人信息（需要认证）- 有 Token
GET {{apiUrl}}/auth/profile
Authorization: Bearer your-token-here

### 21. 获取个人信息（需要认证）- 错误的 Token 格式
GET {{apiUrl}}/auth/profile
Authorization: InvalidFormat

### ========== CORS 测试 ==========

### 22. OPTIONS 请求测试
OPTIONS {{apiUrl}}/users

### ========== 批量测试 ==========

### 23. 创建多个用户
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "user001",
  "email": "user001@example.com",
  "password": "password123",
  "nickname": "用户001"
}

###
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "user002",
  "email": "user002@example.com",
  "password": "password123",
  "nickname": "用户002"
}

###
POST {{apiUrl}}/users
Content-Type: application/json

{
  "username": "user003",
  "email": "user003@example.com",
  "password": "password123",
  "nickname": "用户003"
}
