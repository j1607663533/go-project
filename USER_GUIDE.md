# 🎉 系统使用指南

## ✅ 已修复的问题

### 1. 菜单导航问题

- ✅ 修复了点击 `/system` 父菜单无法跳转的问题
- ✅ 现在父菜单（有子菜单）只会展开/折叠，不会导航
- ✅ 只有叶子菜单（没有子菜单）才会触发页面跳转

### 2. API 调用规范

- ✅ `SystemUsers.jsx` 中的 API 调用已统一通过 `api/auth.js` 管理
- ✅ 添加了 `updateUser` API 函数

### 3. 数据库初始化

- ✅ 更新了 `init_data.sql`，使用 `INSERT IGNORE` 避免重复键错误
- ✅ 支持重复执行，不会报错

## 🚀 快速开始

### 1. 启动系统

**后端**:

```bash
cd backend
go run main.go
```

**前端**:

```bash
npm run dev
```

### 2. 初始化数据库

如果数据库中没有菜单和角色数据，执行：

```bash
cd backend
mysql -u root -p projecttest < init_data.sql
```

### 3. 创建超级管理员

**方法 1: 先注册后设置**

1. 在前端注册一个新账号
2. 执行 SQL：

```sql
USE projecttest;
UPDATE users SET role_id = 1 WHERE username = 'your_username';
```

**方法 2: 使用自动化脚本**

```powershell
cd backend
.\setup_admin.ps1
```

### 4. 登录系统

使用超级管理员账号登录后，你将看到：

- ✅ 首页
- ✅ 订单管理
- ✅ 系统管理
  - 用户管理
  - 角色管理
  - 菜单管理

## 📋 功能说明

### 菜单导航

**父菜单（有子菜单）**:

- 点击后只会展开/折叠子菜单
- 不会触发页面跳转
- 例如：系统管理

**叶子菜单（无子菜单）**:

- 点击后会跳转到对应页面
- 例如：首页、订单管理、用户管理等

### 权限控制

**超级管理员** (role_id = 1):

- 拥有所有菜单权限
- 可以看到所有功能模块
- 不能被删除或修改

**普通用户** (role_id = 2):

- 默认只有首页和订单管理权限
- 看不到系统管理菜单
- 可以通过角色管理分配更多权限

## 🎯 常用操作

### 创建新角色

1. 登录超级管理员账号
2. 进入"系统管理 > 角色管理"
3. 点击"新建角色"
4. 填写角色信息
5. 点击"分配菜单"选择权限

### 为用户分配角色

1. 进入"系统管理 > 用户管理"
2. 找到目标用户，点击"编辑"
3. 选择角色
4. 保存

### 创建新菜单

1. 进入"系统管理 > 菜单管理"
2. 点击"新建菜单"
3. 选择父菜单（0 表示顶级菜单）
4. 填写菜单信息
5. 保存

### 添加新功能模块

1. **创建前端页面**

   - 在 `src/pages/` 创建新组件
   - 例如：`Products.jsx`

2. **添加路由**

   - 在 `src/main.jsx` 中添加路由配置

   ```javascript
   {
     path: "products",
     element: <Products />,
   }
   ```

3. **创建菜单**

   - 在菜单管理中创建菜单
   - 路径：`/products`
   - 组件：`Products`

4. **分配权限**
   - 在角色管理中为相应角色分配该菜单

## 🔧 故障排除

### 1. 看不到系统管理菜单

**原因**: 当前用户不是超级管理员

**解决**:

```sql
UPDATE users SET role_id = 1 WHERE username = 'your_username';
```

### 2. 菜单数据为空

**原因**: 数据库未初始化

**解决**:

```bash
cd backend
mysql -u root -p projecttest < init_data.sql
```

### 3. 点击菜单没反应

**原因**: 可能是父菜单，父菜单只展开不跳转

**解决**: 点击子菜单即可跳转

### 4. 后端报错

**检查**:

- MySQL 服务是否启动
- Redis 服务是否启动（可选）
- `.env` 配置是否正确
- 数据库是否存在

## 📊 数据库信息

**数据库名**: `projecttest`

**表结构**:

- `users` - 用户表
- `roles` - 角色表
- `menus` - 菜单表
- `role_menus` - 角色菜单关联表
- `orders` - 订单表
- `payments` - 支付表

**默认数据**:

- 6 个菜单
- 2 个角色（超级管理员、普通用户）
- 角色菜单关联

## 🎨 界面特性

- ✅ 响应式布局
- ✅ 侧边栏可折叠
- ✅ 动态菜单加载
- ✅ 美观的 Ant Design UI
- ✅ 流畅的交互体验
- ✅ 完善的错误提示

## 📝 技术栈

**前端**:

- React 19
- Ant Design 5
- React Router v7
- Axios

**后端**:

- Go 1.25
- Gin
- GORM
- MySQL
- Redis

## 🙏 支持

如有问题，请查看：

- [快速启动指南](../QUICKSTART.md)
- [数据库初始化指南](./DATABASE_INIT_GUIDE.md)
- [系统页面指南](../SYSTEM_PAGES_GUIDE.md)
- [项目总结](../PROJECT_SUMMARY.md)

---

**最后更新**: 2026-01-06  
**版本**: v1.0.0  
**状态**: ✅ 可用
